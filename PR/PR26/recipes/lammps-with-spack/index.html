
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://orcd.mit.edu/recipes/lammps-with-spack/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Example of building custom LAMMPS configuration using spack - ORCD Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-of-building-custom-lammps-configuration-using-spack" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ORCD Docs" class="md-header__button md-logo" aria-label="ORCD Docs" data-md-component="logo">
      
  <img src="../../images/ORCD_logo_icononly.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ORCD Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Example of building custom LAMMPS configuration using spack
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ORCD Docs" class="md-nav__button md-logo" aria-label="ORCD Docs" data-md-component="logo">
      
  <img src="../../images/ORCD_logo_icononly.png" alt="logo">

    </a>
    ORCD Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../orcd-systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ORCD Systems
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Filesystems and File Transfer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Filesystems and File Transfer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystems-file-transfer/filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Use Filesystems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystems-file-transfer/project-filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Specific Filesystems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../data-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Security and Privacy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ORCD Recipes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            ORCD Recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../mujoco/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MuJoCo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../nvhpc-a100-with-cuda-and-mpi-example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NVHPC with CUDA aware MPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../gromacs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GROMACS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../mpi4py/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MPI for Python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-lammps" class="md-nav__link">
    About LAMMPS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compiling-and-running-a-custom-lammps-using-spack" class="md-nav__link">
    Compiling and running a custom LAMMPS using Spack
  </a>
  
    <nav class="md-nav" aria-label="Compiling and running a custom LAMMPS using Spack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-configure-an-instance-of-spack-in-a-directory-under-your-account" class="md-nav__link">
    1. Configure an instance of Spack in a directory under your account
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-check-what-extra-software-spack-will-build-for-our-lammps-install" class="md-nav__link">
    2. Check what extra software Spack will build for our LAMMPS install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-compile-and-install-lammps" class="md-nav__link">
    3. Compile and install LAMMPS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-running-lammps" class="md-nav__link">
    4. Running LAMMPS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <a href="../../tags/#engaging" class="md-tag">Engaging</a>
    
  
    
    
    
      <a href="../../tags/#howto-recipes" class="md-tag">Howto Recipes</a>
    
  
    
    
    
      <a href="../../tags/#spack" class="md-tag">spack</a>
    
  
    
    
    
      <a href="../../tags/#lammps" class="md-tag">LAMMPS</a>
    
  
    
    
    
      <a href="../../tags/#rocky-linux" class="md-tag">Rocky Linux</a>
    
  
</nav>



<h1 id="example-of-building-custom-lammps-configuration-using-spack">Example of building custom LAMMPS configuration using spack</h1>
<h2 id="about-lammps">About LAMMPS</h2>
<p>LAMMPS is a fully open-source molecular dynamics simulator. 
Its name is an acronym from <a href="https://www.lammps.org">Large-scale Atomic/Molecular Massively Parallel Simulator</a>.
It is widely used in materials research. LAMMPS is actively developed
<a href="https://github.com/lammps">here</a> by a team of collaborators led by researchers from Sandia National Laboratory and 
Temple University. LAMMPS has many different compilation options that can be used to activate different technical and scientific features.</p>
<h2 id="compiling-and-running-a-custom-lammps-using-spack">Compiling and running a custom LAMMPS using Spack</h2>
<p>In this recipe we look at setting up a custom configuration of LAMMPS using the <a href="https://github.com/spack/spack">Spack</a> system. The recipe shows
how to compile LAMMPS in a way that uses an existing Spack install of core tools like MPI and GPU CUDA libraries and tools. The recipe
The detailed steps, that can be executed in an interactive Slurm session, are explained 
below. </p>
<div class="admonition note">
<p class="admonition-title">Prerequisites</p>
<p>This example assumes you have access to a Slurm partition and are working with a Rocky Linux environment.</p>
</div>
<h4 id="1-configure-an-instance-of-spack-in-a-directory-under-your-account">1. Configure an instance of Spack in a directory under your account</h4>
<p>Spack is a tool for compiling programs in a uniform away. It is designed for use by regular accounts on a computer. It does not need any administrative privileges.
Here it will be used to compile the LAMMPS software. </p>
<p>A first step to using Spack is to download the software from its Github repository using the following command.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/spack/spack.git
</span></code></pre></div>
<p>Next we configure Spack, setting the it ot use standard tools that have already been built from a pre-exisiting location.</p>
<details class="note">
<summary>Note</summary>
<p>The compilation example shows using Spack in a way that uses pre-existing <em>upstream</em> Spack built software 
from another location. This can be useful on a cluster computer where a central team may have already installed and configured some standard foundation software tools, 
such as a compiler and high-performance tools for using GPUs and/or for parallel communication. Configuring these foundation software tools can involve seaprate
testing and performance settings, so using a pre-installed foundation is generally useful. To make a Spack <em>upstream</em> work reliably we need to use the same tag of 
Spack as used in the upstream and provide a path name to the upstream isntallation.</p>
</details>
<p>To configure Spack use the following sequence of commands.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Switch to build location</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>/nobackup1/users/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/lammps-testing
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nb">cd</span><span class="w"> </span>/nobackup1/users/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/lammps-testing
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># Set any .spack files to be local to this test</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SPACK_USER_CONFIG_PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/user_config
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1"># Download spack and set version to match upstream Spack</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/spack/spack.git
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="o">(</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>spack
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>v0.19.1<span class="w"> </span>v0.19.1
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="o">)</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c1"># Set upstream and cp reference config files for upstream</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/user_config
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>cp<span class="w"> </span>/software/spack/etc/spack/*yaml<span class="w"> </span>user_config
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>cat<span class="w">  </span>&gt;<span class="w"> </span>user_config/upstreams.yaml<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="s">upstreams:</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="s">  orcd-rcf-2023:</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="s">   install_tree: /software/spack-20230328/opt/spack</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="s">EOF</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="nb">source</span><span class="w"> </span>spack/share/spack/setup-env.sh
</span></code></pre></div>
<h4 id="2-check-what-extra-software-spack-will-build-for-our-lammps-install">2. Check what extra software Spack will build for our LAMMPS install</h4>
<p>Spack will download and compile extra software that it needs to compile LAMMPS. 
It is good to check what software Spack selects to build to make sure that 
the <em>upstream</em> libraries are being used as epxected.</p>
<p>To check the software Spack will build use the commad.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>spack<span class="w"> </span>spec<span class="w"> </span>-I<span class="w"> </span>-L<span class="w"> </span>lammps%gcc@12.2.0<span class="w"> </span><span class="nv">fftw_precision</span><span class="o">=</span>single<span class="w"> </span>+intel<span class="w"> </span>~kim<span class="w"> </span>+asphere<span class="w"> </span>+class2<span class="w"> </span>+kspace<span class="w"> </span>+manybody<span class="w"> </span>+molecule<span class="w"> </span>+opt<span class="w"> </span>+replica<span class="w"> </span>+rigid<span class="w"> </span>+granular<span class="w"> </span>+openmp-package<span class="w"> </span>+openmp<span class="w"> </span>^openmpi
</span></code></pre></div>
<p>this command produces a large amount of output that is described below.</p>
<details class="example">
<summary>Output from spack spec -I -L query</summary>
<p>The<code>spack spec -I -L</code> command produces a series of lines that show the versions of all the software packages that
are needed for some software. The first column in these lines show symbols that denote whether an existing 
version will be used ( [^], or [e] ) or a new version needs to be downloaded and installed ( [+] ). </p>
<p>If there are many packages marked with the [+] it can be useful to check what options you have selected for the software
you are trying to build. Changing these options can affect how Spack decides which packages needs to be
built frm scratch.
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Input spec
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>--------------------------------
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a> -   lammps%gcc@12.2.0+asphere+class2+granular+intel~kim+kspace+manybody+molecule+openmp+openmp-package+opt+replica+rigid fftw_precision=single
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a> -       ^openmpi
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>Concretized
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>--------------------------------
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>[+]  murlzo54sqte5xacqcusa6pdmuv7lbju  lammps@20220623%gcc@12.2.0~adios+asphere~atc~awpmd~bocs~body~bpm~brownian~cg-sdk+class2~colloid~colvars~compress~coreshell~cuda~cuda_mps~dielectric~diffraction~dipole~dpd-basic~dpd-meso~dpd-react~dpd-smooth~drude~eff~electrode~exceptions~extra-compute~extra-dump~extra-fix~extra-molecule~extra-pair~fep+ffmpeg+granular~h5md+intel~interlayer~ipo+jpeg~kim~kokkos+kspace~latboltz~latte+lib~machdyn~manifold+manybody~mc~meam~mesont~mgpt~misc~ml-iap~ml-snap~mliap~mofff+molecule~molfile+mpi~mpiio~netcdf~opencl+openmp+openmp-package+opt~orient~peri~phonon~plugin~plumed+png~poems~ptm~python~qeq~qtb~reaction~reaxff+replica+rigid~shock~smtbq~snap~sph~spin~srd~tally~uef~user-adios~user-atc~user-awpmd~user-bocs~user-brownian~user-cgsdk~user-colvars~user-diffraction~user-dpd~user-drude~user-eff~user-fep~user-h5md~user-intel~user-lb~user-manifold~user-meamc~user-mesodpd~user-mesont~user-mgpt~user-misc~user-mofff~user-molfile~user-netcdf~user-omp~user-phonon~user-plumed~user-ptm~user-qtb~user-reaction~user-reaxc~user-sdpd~user-smd~user-smtbq~user-sph~user-tally~user-uef~user-yaff~voronoi~yaff build_system=cmake build_type=RelWithDebInfo fftw_precision=single lammps_sizes=smallbig arch=linux-rocky8-x86_64
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>[^]  7kayesehfqsqbz3anbeuesrhg7jivrh7      ^cmake@3.24.3%gcc@12.2.0~doc+ncurses+ownlibs~qt build_system=generic build_type=Release arch=linux-rocky8-x86_64
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>[^]  c5ckfq5br4hzxtjpinax3wmblpxcwccq          ^ncurses@6.3%gcc@12.2.0~symlinks+termlib abi=none build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>[^]  teeyrkysydy6st2gjgmlilsqhdvhytxg          ^openssl@1.1.1s%gcc@12.2.0~docs~shared build_system=generic certs=mozilla arch=linux-rocky8-x86_64
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>[^]  acak7eo66b264d5tnlrgdsqquriqzikw              ^ca-certificates-mozilla@2022-10-11%gcc@12.2.0 build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>[+]  o2bzn3dn2oxv3z2gxmjdbqdrg2cujdub      ^ffmpeg@4.4.1%gcc@12.2.0~X~avresample+bzlib~drawtext+gpl~libaom~libmp3lame~libopenjpeg~libopus~libsnappy~libspeex~libssh~libvorbis~libvpx~libwebp~libx264~libzmq~lzma~nonfree~openssl~sdl2+shared+version3 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>[+]  da4dhnudfslxlganozpe6kgegttb5wqt          ^alsa-lib@1.2.3.2%gcc@12.2.0~python build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>[^]  y2uodljjpotqgdgf4ync654ow6zq3yui          ^bzip2@1.0.8%gcc@12.2.0~debug~pic+shared build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>[^]  lmmbcwxrpcrrdzfv46acihazdbchects              ^diffutils@3.6%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>[^]  y7hkdyocmeei7gipuzq6dauwoscds65d          ^libiconv@1.16%gcc@12.2.0 build_system=autotools libs=shared,static arch=linux-rocky8-x86_64
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>[+]  up3oys25bdxvv5n2cdvhyaodk4pjm46t          ^yasm@1.3.0%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>[^]  xzya3i6ni4zkbycrk2bnbwba3dtfjpag          ^zlib@1.2.13%gcc@12.2.0+optimize+pic+shared build_system=makefile arch=linux-rocky8-x86_64
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>[^]  qiaruimvw6zu2h4f5eolqom7tixem6vk      ^fftw@3.3.10%gcc@12.2.0+mpi+openmp~pfft_patches build_system=autotools precision=double,float arch=linux-rocky8-x86_64
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>[^]  ig3drj7aya7pibjynlbjdki4wj26nvq3      ^libjpeg-turbo@2.1.3%gcc@12.2.0 build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>[^]  t4dj6jrogzp26ylmy7meqdm5uerw2vou          ^nasm@2.15.05%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>[^]  bpm4irmoa3ly7mn2v2eezr4nvoxt57uz      ^libpng@1.6.37%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>[^]  3r4zaihkaqj2gmfvtzk4adiu3qxlzgj5      ^openmpi@4.1.4%gcc@12.2.0~atomics+cuda~cxx~cxx_exceptions~gpfs~internal-hwloc~java+legacylaunchers~lustre~memchecker+pmi+romio+rsh~singularity+static+vt+wrapper-rpath build_system=autotools cuda_arch=none fabrics=ucx schedulers=slurm arch=linux-rocky8-x86_64
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>[^]  loulnd3xxa433rvdvtzu67nb4muiyxqt          ^cuda@12.1.0%gcc@12.2.0~allow-unsupported-compilers~dev build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>[^]  avncq4uc2k673jnoxdeqijalhwxfu452              ^libxml2@2.10.1%gcc@12.2.0~python build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>[^]  a7ikzndwlj3et447m7ycfy3rjnllhr6c                  ^xz@5.2.7%gcc@12.2.0~pic build_system=autotools libs=shared,static arch=linux-rocky8-x86_64
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>[^]  a56oj35bkhqi7rpsxyrzv2cvjhk6f4nl          ^hwloc@2.8.0%gcc@12.2.0~cairo+cuda~gl~libudev+libxml2~netloc+nvml~oneapi-level-zero~opencl+pci~rocm build_system=autotools cuda_arch=none libs=shared,static arch=linux-rocky8-x86_64
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>[^]  id32hkaz34tj6rm436wmiaoes7jtjomj              ^libpciaccess@0.16%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>[^]  74pwk3n734nymhilw7fvcjhkdzr22xa5                  ^util-macros@1.19.3%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>[^]  n3atoewxkrcnzrv35ggcghde7uknwnc2          ^numactl@2.0.14%gcc@12.2.0 build_system=autotools patches=4e1d78c,62fc8a8,ff37630 arch=linux-rocky8-x86_64
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>[^]  llmf6eoq46fjuega6mzjc6kjpeta2abx              ^autoconf@2.69%gcc@12.2.0 build_system=autotools patches=35c4492,7793209,a49dd5b arch=linux-rocky8-x86_64
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>[^]  t3rctjlwqpmn5x433eeeusphmtypv6g7              ^automake@1.16.5%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>[^]  lmcpaypsio2xylqqkhyis36sem4q2uqx              ^libtool@2.4.7%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>[^]  fqwqfqqkhvsw7oklwjgsgfz5ksfantur              ^m4@1.4.18%gcc@12.2.0+sigsegv build_system=autotools patches=3877ab5,fc9b616 arch=linux-rocky8-x86_64
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>[^]  o3v3w2aysw3bxl2ioig7bu4nl54xb6ln          ^openssh@8.0p1%gcc@12.2.0+gssapi build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>[^]  d345fqycp52qf5jf35in4tkz3bg7en2t          ^perl@5.36.0%gcc@12.2.0+cpanm+shared+threads build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a>[^]  ehlkmyphsdbfkgvt6wtznpvs6gpelo4a              ^berkeley-db@18.1.40%gcc@12.2.0+cxx~docs+stl build_system=autotools patches=26090f4,b231fcc arch=linux-rocky8-x86_64
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>[^]  medv6udj2ovi3p7sjpffxzfl4t4yb6i2              ^gdbm@1.23%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>[^]  5zhrz242nlulabfgalogdv6vgxfnigae                  ^readline@8.1.2%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>[^]  wxuqfjdqv4bjudl2aixkqcowfz35q62u          ^pkgconf@1.8.0%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a>[^]  d7f7fwzoomvmc6hwotduhlzmdoc6oz7o          ^pmix@4.1.2%gcc@12.2.0~docs+pmi_backwards_compatibility~restful build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>[^]  dnasb7atyzwlagnyyrplzk5if6efrfbe              ^libevent@2.1.12%gcc@12.2.0+openssl build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a>[^]  w4bduhiz53fpkwuucvzayhpj7dquy6wa          ^slurm@22.05.6%gcc@12.2.0~gtk~hdf5~hwloc~mariadb+pmix+readline~restd build_system=autotools sysconfdir=PREFIX/etc arch=linux-rocky8-x86_64
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a>[^]  xxapazpv4rciyeuajxom5vfll4djhakq          ^ucx@1.13.1%gcc@12.2.0~assertions~backtrace_detail+cma+cuda+dc~debug+dm+examples+gdrcopy+ib_hw_tm~java+knem~logging+mlx5_dv+openmp+optimizations~parameter_checking+pic+rc+rdmacm~rocm+thread_multiple~ucg+ud+verbs~vfs+xpmem build_system=autotools cuda_arch=none libs=shared,static opt=3 patches=32fce32 simd=auto arch=linux-rocky8-x86_64
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a>[^]  6mhshpnmk5eluz3l7kkiiwaijetaugaz              ^gdrcopy@2.3%gcc@12.2.0 build_system=makefile patches=c5efec1 arch=linux-rocky8-x86_64
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>[^]  lf6nroe2ungmj4jfktllyn3lb634phai              ^knem@1.1.4%gcc@12.2.0+hwloc build_system=autotools patches=78885a0 arch=linux-rocky8-x86_64
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a>[^]  y7we5jx3cbxrdetx4czervl3x5u6sw4d              ^rdma-core@41.0%gcc@12.2.0~ipo build_system=cmake build_type=RelWithDebInfo arch=linux-rocky8-x86_64
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>[^]  tf5fu6kqufhtdnnt4v3xyzpyomqlod3x                  ^libnl@3.3.0%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a>[^]  c4tgrq23hiatbdxkxdsvuzure2uu3igf                      ^bison@3.8.2%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>[^]  n4ex34zvvefzgb3kujwzymjcjx7bqy72                      ^flex@2.6.3%gcc@12.2.0+lex~nls build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>[^]  jofcfnbajncj3a3ooylnkls4zrg2gd7u                          ^findutils@4.6.0%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a>[^]  imomhs5czwwjpjwka3pchqoqmvhkybta                  ^py-docutils@0.19%gcc@12.2.0 build_system=python_pip arch=linux-rocky8-x86_64
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a>[^]  ru3kxolfjtu3dna4ou6ebnd34xxqdgug                      ^py-pip@22.2.2%gcc@12.2.0 build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a>[^]  2ze2pnic7bshbeu635yejl6325b57bfh                      ^py-setuptools@65.5.0%gcc@12.2.0 build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>[^]  2fvi4pmz4mnqmufgbdusfg3jbxq2xkrn                      ^py-wheel@0.37.1%gcc@12.2.0 build_system=generic arch=linux-rocky8-x86_64
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a>[^]  flipoyygqdyq56ytifzzitgmb7x4bdno                      ^python@3.10.8%gcc@12.2.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib build_system=generic patches=0d98e93,7d40923,f2fd060 arch=linux-rocky8-x86_64
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a>[^]  fw7viptexxob2jlhoimbbx2iuelorefg                          ^expat@2.4.8%gcc@12.2.0+libbsd build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a>[^]  wem5x2oesmhxmfp7x63sgdop57ribigd                              ^libbsd@0.11.5%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a>[^]  jxvqhjl7uir2utgpdxzxho744wnbyicj                                  ^libmd@1.0.4%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a>[^]  srssurbwe76knqj3m2a2g3yl6htki75r                          ^gettext@0.21.1%gcc@12.2.0+bzip2+curses+git~libunistring+libxml2+tar+xz build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>[^]  4phps4fxpvnorsqhbbizp34nmxgcbhlv                              ^tar@1.30%gcc@12.2.0 build_system=autotools zip=pigz arch=linux-rocky8-x86_64
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a>[^]  ag3cenfsq7igpp33kkdgs5l6llm7mfaa                          ^libffi@3.4.2%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a>[^]  uvuc44zwmae3ypmqvjrpymleierkahwj                          ^sqlite@3.39.4%gcc@12.2.0+column_metadata+dynamic_extensions+fts~functions+rtree build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a>[^]  f36megz6i272yo6gqj2h72byzupu2u3f                          ^util-linux-uuid@2.38.1%gcc@12.2.0 build_system=autotools arch=linux-rocky8-x86_64
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a>[^]  omne2gv2jqp4wmdqfnb6wfozhda6mznn              ^xpmem@2.6.5-36%gcc@12.2.0+kernel-module build_system=autotools patches=1a2660a,6be8c5f,7529939 arch=linux-rocky8-x86_64
</span></code></pre></div></p>
</details>
<p>Assuming the <code>spack spec</code> command does not show that a large number of unexpected dependencies will be 
built, then the command <code>spack install</code> can be used to build the software.</p>
<h4 id="3-compile-and-install-lammps">3. Compile and install LAMMPS</h4>
<p>To compile and build LAMMPS once the spack specification is </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>spack<span class="w"> </span>spec<span class="w"> </span>install<span class="w"> </span>lammps%gcc@12.2.0<span class="w"> </span><span class="nv">fftw_precision</span><span class="o">=</span>single<span class="w"> </span>+intel<span class="w"> </span>~kim<span class="w"> </span>+asphere<span class="w"> </span>+class2<span class="w"> </span>+kspace<span class="w"> </span>+manybody<span class="w"> </span>+molecule<span class="w"> </span>+opt<span class="w"> </span>+replica<span class="w"> </span>+rigid<span class="w"> </span>+granular<span class="w"> </span>+openmp-package<span class="w"> </span>+openmp<span class="w"> </span>^openmpi
</span></code></pre></div>
<p>this command will produce output showing progress and generate an executable <code>lmp</code> program file when it 
completes.</p>
<h4 id="4-running-lammps">4. Running LAMMPS</h4>
<p>Once LAMMPS has been built, simulations can be carried out using the <code>lmp</code> program.
The following script shows an example Slurm job that executes a simulation using the Spack LAMMPS installation shown.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1">#!/bin/bash</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1">#SBATCH -N 1</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1">#SBATCH -p sched_mit_orcd</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">#SBATCH --exclusive</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c1">#</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1">#</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Start: &quot;</span><span class="sb">`</span>date<span class="sb">`</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>hostname
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>lscpu
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="nb">cd</span><span class="w"> </span>/nobackup1c/users/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/lammps-testing
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SPACK_USER_CONFIG_PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/user_config
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="nb">source</span><span class="w"> </span>spack/share/spack/setup-env.sh
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>spack<span class="w"> </span>load<span class="w"> </span>lammps
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>which<span class="w"> </span>lmp
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>/bin/rm<span class="w"> </span><span class="k">in</span>.rhodo.scaled
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>/bin/rm<span class="w"> </span>data.rhodo
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>wget<span class="w"> </span>https://raw.githubusercontent.com/lammps/lammps/develop/bench/in.rhodo.scaled
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>wget<span class="w"> </span>https://raw.githubusercontent.com/lammps/lammps/develop/bench/data.rhodo
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="nb">export</span><span class="w"> </span><span class="nv">NP</span><span class="o">=</span><span class="k">$(</span>nproc<span class="k">)</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="si">${</span><span class="nv">NP</span><span class="si">}</span><span class="w"> </span>--map-by<span class="w"> </span>core<span class="w"> </span>--bind-to<span class="w"> </span>core<span class="w"> </span>lmp<span class="w"> </span>-var<span class="w"> </span>x<span class="w"> </span><span class="m">8</span><span class="w"> </span>-var<span class="w"> </span>y<span class="w"> </span><span class="m">8</span><span class="w"> </span>-var<span class="w"> </span>z<span class="w"> </span><span class="m">8</span><span class="w"> </span>-in<span class="w"> </span><span class="k">in</span>.rhodo.scaled<span class="w"> </span>-sf<span class="w"> </span>omp<span class="w"> </span>-pk<span class="w"> </span>omp<span class="w"> </span><span class="m">1</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;End: &quot;</span><span class="sb">`</span>date<span class="sb">`</span>
</span></code></pre></div>
<details class="example example lammps output">
<summary>Example</summary>
<p>LAMMPS (23 Jun 2022)
 OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/src/comm.cpp:98)
   using 1 OpenMP thread(s) per MPI task
 using multi-threaded neighbor list subroutines
 using multi-threaded neighbor list subroutines
 Reading data file ...
   orthogonal box = (-27.5 -38.5 -36.3646) to (27.5 38.5 36.3615)
   4 by 8 by 4 MPI processor grid
   reading atoms ...
   32000 atoms
   reading velocities ...
   32000 velocities
   scanning bonds ...
   4 = max bonds/atom
   scanning angles ...
   8 = max angles/atom
   scanning dihedrals ...
   18 = max dihedrals/atom
   scanning impropers ...
   2 = max impropers/atom
   reading bonds ...
   27723 bonds
   reading angles ...
   40467 angles
   reading dihedrals ...
   56829 dihedrals
   reading impropers ...
   1034 impropers
 Finding 1-2 1-3 1-4 neighbors ...
   special bond factors lj:    0        0        0     <br />
   special bond factors coul:  0        0        0     <br />
      4 = max # of 1-2 neighbors
     12 = max # of 1-3 neighbors
     24 = max # of 1-4 neighbors
     26 = max # of special neighbors
   special bonds CPU = 0.011 seconds
   read_data CPU = 2.852 seconds
 Replicating atoms ...
   orthogonal box = (-27.5 -38.5 -36.3646) to (412.5 577.5 545.4442)
   4 by 8 by 4 MPI processor grid
   16384000 atoms
   14194176 bonds
   20719104 angles
   29096448 dihedrals
   529408 impropers
 Finding 1-2 1-3 1-4 neighbors ...
   special bond factors lj:    0        0        0     <br />
   special bond factors coul:  0        0        0     <br />
      4 = max # of 1-2 neighbors
     12 = max # of 1-3 neighbors
     24 = max # of 1-4 neighbors
     26 = max # of special neighbors
   special bonds CPU = 0.414 seconds
   replicate CPU = 1.160 seconds
 Finding SHAKE clusters ...
   827904 = # of size 2 clusters
  1860096 = # of size 3 clusters
   382464 = # of size 4 clusters
  2167296 = # of frozen angles
   find clusters CPU = 0.224 seconds
 PPPM initialization ...
   using 12-bit tables for long-range coulomb (src/src/kspace.cpp:342)
   G vector (1/distance) = 0.24521748
   grid = 192 250 240
   stencil order = 5
   estimated absolute RMS force accuracy = 0.042505564
   estimated relative force accuracy = 0.00012800424
   using single precision FFTW3
   3d grid and FFT values/proc = 127465 96000
 Generated 2278 of 2278 mixed pair_coeff terms from arithmetic mixing rule
 Last active /omp style is kspace_style pppm/omp
 Neighbor list info ...
   update every 1 steps, delay 5 steps, check yes
   max neighbors/atom: 2000, page size: 100000
   master list distance cutoff = 12
   ghost atom cutoff = 12
   binsize = 6, bins = 74 103 97
   1 neighbor lists, perpetual/occasional/extra = 1 0 0
   (1) pair lj/charmm/coul/long/omp, perpetual
       attributes: half, newton on, omp
       pair build: half/bin/newton/omp
       stencil: half/bin/3d
       bin: standard
 Setting up Verlet run ...
   Unit style    : real
   Current step  : 0
   Time step     : 2
 Per MPI rank memory allocation (min/avg/max) = 474.8 | 475.2 | 475.5 Mbytes
 ------------ Step              0 ----- CPU =            0 (sec) -------------
 TotEng   = -12982067.8140 KinEng   =  10979753.6175 Temp     =       299.0273 
 PotEng   = -23961821.4315 E_bond   =   1299452.9334 E_angle  =   5591743.5948 
 E_dihed  =   2668434.6878 E_impro  =    109317.9317 E_vdwl   =  -1181626.0687 
 E_coul   = 103991193.7841 E_long   = -136440338.2946 Press    =      -148.6868 
 Volume   = 157693457.1520
 ------------ Step             50 ----- CPU =      71.9645 (sec) -------------
 TotEng   = -12968333.4738 KinEng   =  11008585.3549 Temp     =       299.8125 
 PotEng   = -23976918.8287 E_bond   =   1265564.5807 E_angle  =   5548389.0103 
 E_dihed  =   2682753.7530 E_impro  =    116287.8102 E_vdwl   =  -1020413.6793 
 E_coul   = 103874278.6508 E_long   = -136443778.9543 Press    =       238.7597 
 Volume   = 157712315.3857
 ------------ Step            100 ----- CPU =     146.7313 (sec) -------------
 TotEng   = -12948011.3076 KinEng   =  11054762.8499 Temp     =       301.0701 
 PotEng   = -24002774.1575 E_bond   =   1314890.4683 E_angle  =   5520457.6514 
 E_dihed  =   2661664.1153 E_impro  =    110960.4410 E_vdwl   =   -972029.7085 
 E_coul   = 103802332.6863 E_long   = -136441049.8112 Press    =        11.4791 
 Volume   = 157765159.5585
 Loop time of 146.731 on 128 procs for 100 steps with 16384000 atoms</p>
<p>Performance: 0.118 ns/day, 203.794 hours/ns, 0.682 timesteps/s
 98.5% CPU use with 128 MPI tasks x 1 OpenMP threads</p>
<p>MPI task timing breakdown:
 Section |  min time  |  avg time  |  max time  |%varavg| %total</p>
<hr />
<p>Pair    | 95.91      | 97.23      | 99.421     |   8.9 | 66.26
 Bond    | 4.1898     | 4.4685     | 4.6336     |   3.5 |  3.05
 Kspace  | 11.902     | 14.256     | 15.701     |  24.0 |  9.72
 Neigh   | 19.24      | 19.289     | 19.34      |   0.5 | 13.15
 Comm    | 1.9089     | 2.2363     | 2.8188     |  12.9 |  1.52
 Output  | 0.0025599  | 0.0026735  | 0.0028835  |   0.1 |  0.00
 Modify  | 7.4504     | 8.648      | 9.5588     |  15.0 |  5.89
 Other   |            | 0.6015     |            |       |  0.41</p>
<p>Nlocal:         128000 ave      128000 max      128000 min
 Histogram: 128 0 0 0 0 0 0 0 0 0
 Nghost:         109934 ave      109937 max      109930 min
 Histogram: 32 0 32 0 0 0 0 32 0 32
 Neighs:    4.81125e+07 ave 4.83216e+07 max  4.7899e+07 min
 Histogram: 8 8 12 18 16 20 16 12 10 8</p>
<p>Total # of neighbors = 6.1583993e+09
 Ave neighs/atom = 375.87887
 Ave special neighs/atom = 7.431875
 Neighbor list builds = 11
 Dangerous builds = 0
 Total wall time: 0:02:36
 End: Thu Oct 26 15:16:19 EDT 2023</p>
</details>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 26, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href="https://accessibility.mit.edu/">Accessibility</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>