
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://orcd.mit.edu/recipes/basic_vasp_gcc_example/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.5">
    
    
      
        <title>Example of a build of the VASP software. - ORCD Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6a10b989.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-of-a-build-of-the-vasp-software" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ORCD Docs" class="md-header__button md-logo" aria-label="ORCD Docs" data-md-component="logo">
      
  <img src="../../images/ORCD_logo_icononly.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ORCD Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Example of a build of the VASP software.
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ORCD Docs" class="md-nav__button md-logo" aria-label="ORCD Docs" data-md-component="logo">
      
  <img src="../../images/ORCD_logo_icononly.png" alt="logo">

    </a>
    ORCD Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../orcd-systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ORCD Systems
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Filesystems and File Transfer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Filesystems and File Transfer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystems-file-transfer/filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Use Filesystems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystems-file-transfer/project-filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Specific Filesystems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../data-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Security and Privacy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ORCD Recipes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            ORCD Recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../mujoco/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MuJoCo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../nvhpc-a100-with-cuda-and-mpi-example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NVHPC with CUDA aware MPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../gromacs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GROMACS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../mpi4py/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MPI for Python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-vasp" class="md-nav__link">
    About VASP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-vasp-software" class="md-nav__link">
    Building VASP software
  </a>
  
    <nav class="md-nav" aria-label="Building VASP software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-extract-vasp-source-code-files" class="md-nav__link">
    1. Extract VASP source code files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configure-the-compiler-options-file" class="md-nav__link">
    2. Configure the compiler options file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-activate-the-relevant-modules" class="md-nav__link">
    3. Activate the relevant modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-set-environment-variables-that-are-needed-for-compilation" class="md-nav__link">
    4. Set environment variables that are needed for compilation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-compile-the-vasp-code" class="md-nav__link">
    5. Compile the VASP code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-check-the-vasp-executables" class="md-nav__link">
    6. Check the VASP executables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <a href="../../tags/#engaging" class="md-tag">Engaging</a>
    
  
    
    
    
      <a href="../../tags/#howto-recipes" class="md-tag">Howto Recipes</a>
    
  
    
    
    
      <a href="../../tags/#mpi" class="md-tag">MPI</a>
    
  
    
    
    
      <a href="../../tags/#cuda" class="md-tag">cuda</a>
    
  
    
    
    
      <a href="../../tags/#cuda-aware-mpi" class="md-tag">cuda aware mpi</a>
    
  
    
    
    
      <a href="../../tags/#gpu" class="md-tag">GPU</a>
    
  
    
    
    
      <a href="../../tags/#vasp" class="md-tag">VASP</a>
    
  
    
    
    
      <a href="../../tags/#rocky-linux" class="md-tag">Rocky Linux</a>
    
  
</nav>



<h1 id="example-of-a-build-of-the-vasp-software">Example of a build of the VASP software.</h1>
<h2 id="about-vasp">About VASP</h2>
<p><a href="https://www.vasp.at">VASP</a> is a first principles simulation tool for electronic structure and quantum mechanical molelcular dynamics computations. The name VASP is an acronym of Vienna Ab-initio Simulation Package. The VASP software is used in quantum chemistry to simulate the properties and structure of atomic scale materials. VASP can compute
detailed atomic structure of molecules, finding terms such as bond lengths and vibration frequencies.</p>
<h2 id="building-vasp-software">Building VASP software</h2>
<p>VASP is distributed as Fortran source code that must be compiled by end-users to create an executable program. This recipe describes how to compile
VASP using the GNU compiler stack. The recipe shows commands for a Rocky Linux system.</p>
<div class="admonition note">
<p class="admonition-title">Prerequisites</p>
<ul>
<li>To use VASP a research group must obtain a license from the VASP team as described here <a href="https://www.vasp.at/sign_in/registration_form/">here</a>.</li>
<li>This example assumes you have access to a Slurm partition and are working with a Rocky Linux environment.</li>
</ul>
</div>
<h4 id="1-extract-vasp-source-code-files">1. Extract VASP source code files</h4>
<p>Once a licensed copy of VASP has been obtained the source code files must be extracted from the provided tar file that is
distributed. The command</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>tar<span class="w"> </span>-xzvf<span class="w"> </span>vasp.6.4.2.tgz
</span></code></pre></div>
<p>will extract the source files and their directory tree. This command should be executed in a sub-directory where you will
store the compiled VASP programs. </p>
<p>Once the code has been extracted, switch to use the VASP directory for the remaining steps</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span>vasp.6.4.2
</span></code></pre></div>
<details class="tip">
<summary>Tip</summary>
<p>For different versions of VASP, the download file name and directory name will be different. In that case, remember to adjust the example commands above accordingly.</p>
</details>
<h4 id="2-configure-the-compiler-options-file">2. Configure the compiler options file</h4>
<p>The VASP software is distributed with multiple example compiler options files. 
These are in the sub-directory <code>arch/</code>. 
For this example we will use the GNU compiler options file <code>makefile.include.gnu_omp</code>. 
To activate the chosen options, copy the options file into the top-level VASP directory.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>cp<span class="w"> </span>arch/makefile.include.gnu_omp<span class="w"> </span>makefile.include
</span></code></pre></div>
<h4 id="3-activate-the-relevant-modules">3. Activate the relevant modules</h4>
<p>To build the vasp program from the licensed source code several tools and libraries are needed. 
The modules below add the needed software. 
The <code>gcc</code> and <code>openmpi</code> modules provide compilers (gcc) and computational tools (openmpi) 
needed for parallel computing with VASP. 
The <code>lapack</code>, <code>scalapack</code>, <code>fftw</code> and <code>openblas</code> toos are numerical libraries that VASP uses.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>module<span class="w"> </span>load<span class="w"> </span>gcc/12.2.0-x86_64
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>module<span class="w"> </span>load<span class="w"> </span>openmpi/4.1.4-pmi-cuda-ucx-x86_64
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>module<span class="w"> </span>load<span class="w"> </span>netlib-lapack/3.10.1-x86_64
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>module<span class="w"> </span>load<span class="w"> </span>netlib-scalapack/2.2.0-x86_64
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>module<span class="w"> </span>load<span class="w"> </span>fftw/3.3.10-x86_64
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>module<span class="w"> </span>load<span class="w"> </span>openblas/0.3.21-x86_64
</span></code></pre></div>
<h4 id="4-set-environment-variables-that-are-needed-for-compilation">4. Set environment variables that are needed for compilation</h4>
<p>The compilation scripts that come with VASP include variables that must be set to
the clusters local values. Here we set environment variables to hold those settings.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">SCALAPACK_ROOT</span><span class="o">=</span><span class="sb">`</span>module<span class="w"> </span>-t<span class="w"> </span>show<span class="w">  </span>netlib-scalapack<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>CMAKE_PREFIX_PATH<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span>-F,<span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span>-F<span class="se">\&quot;</span><span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nv">FFTW_ROOT</span><span class="o">=</span><span class="sb">`</span>pkgconf<span class="w"> </span>--variable<span class="o">=</span>prefix<span class="w"> </span>fftw3<span class="sb">`</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nv">OPENBLAS_ROOT</span><span class="o">=</span><span class="k">$(</span>dirname<span class="w"> </span><span class="sb">`</span>pkgconf<span class="w"> </span>--variable<span class="o">=</span>libdir<span class="w"> </span>openblas<span class="sb">`</span><span class="k">)</span>
</span></code></pre></div>
<h4 id="5-compile-the-vasp-code">5. Compile the VASP code</h4>
<p>To compile the VASP code use the <code>make</code> program, passing it the environment variable settings as
shown. The settings shown will also build the Fortran 90 modules that VASP includes. Typically th</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="nv">OPENBLAS_ROOT</span><span class="o">=</span><span class="nv">$OPENBLAS_ROOT</span><span class="w"> </span><span class="nv">FFTW_ROOT</span><span class="o">=</span><span class="nv">$FFTW_ROOT</span><span class="w"> </span><span class="nv">SCALAPACK_ROOT</span><span class="o">=</span><span class="nv">$SCALAPACK_ROOT</span><span class="w"> </span><span class="nv">MODS</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DEPS</span><span class="o">=</span><span class="m">1</span>
</span></code></pre></div>
<h3 id="6-check-the-vasp-executables">6. Check the VASP executables</h3>
<p>The above commands should generate VASP executable programs <code>build/std/vasp</code>, <code>build/gam/vasp</code> and</p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 11, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href="https://accessibility.mit.edu/">Accessibility</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>